<!DOCTYPE html>
<html lang="fr">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ticket Cadeau üéÅ</title>

<style>

/* ---------- FOND ANIM√â ---------- */
body{
 margin:0;
 font-family:Arial;
 background: linear-gradient(135deg,#667eea,#764ba2,#ff7eb3);
 background-size: 400% 400%;
 animation: gradientMove 15s ease infinite;
}

@keyframes gradientMove{
 0%{background-position:0% 50%;}
 50%{background-position:100% 50%;}
 100%{background-position:0% 50%;}
}

/* petites particules */
body::after{
 content:"";
 position:fixed;
 inset:0;
 background-image: radial-gradient(white 1px, transparent 1px);
 background-size:35px 35px;
 opacity:0.15;
 pointer-events:none;
}

/* ---------- CARTE ---------- */
.ticket{
 width:100%;
 max-width:600px;
 min-height:100vh;
 margin:auto;
 background:white;
 padding:25px;
 box-sizing:border-box;
 text-align:center;
 border-radius:18px;
}

/* ---------- SCRATCH ---------- */
#scratch-container{
 width:100%;
 aspect-ratio:4/3;
 margin-top:20px;
}

canvas{
 width:100%;
 height:100%;
 border-radius:15px;
 touch-action:none;
}

/* ---------- TEXTES ---------- */
h2{
 font-size:28px;
 margin-top:0;
}

h3{
 font-size:24px;
}

p{
 font-size:20px;
}

/* ---------- QUESTIONS ---------- */
#question1,#question2,#revealBtn,#result{
 display:none;
 opacity:0;
 transition:0.5s;
}

/* ---------- BOUTONS ---------- */
button{
 width:90%;
 font-size:22px;
 padding:18px;
 margin:10px auto;
 border:none;
 border-radius:14px;
 background:linear-gradient(135deg,#667eea,#764ba2);
 color:white;
 display:block;
}

/* ---------- BILLET AVION ---------- */
.boarding-pass{
 background:white;
 border-radius:18px;
 padding:25px;
 margin-top:20px;
 box-shadow:0 20px 50px rgba(0,0,0,0.25);
 text-align:left;
 animation:ticketReveal 1s ease;
}

.flight-title{
 text-align:center;
 font-size:26px;
 margin-bottom:20px;
}

.flight-row{
 display:flex;
 justify-content:space-between;
 margin:12px 0;
 font-size:20px;
 border-bottom:1px dashed #ccc;
 padding-bottom:8px;
}

.flight-row span{
 color:#777;
}

@keyframes ticketReveal{
 from{
  transform:scale(0.7) rotateY(90deg);
  opacity:0;
 }
 to{
  transform:scale(1) rotateY(0);
  opacity:1;
 }
}

/* ---------- IMAGE CADEAU ---------- */
.gift-img{
 width:100%;
 margin-top:20px;
 border-radius:14px;
 box-shadow:0 10px 25px rgba(0,0,0,0.2);
 opacity:0;
 transform:scale(0.6);
 transition:0.8s ease;
}

/* effet apparition cadeau */
.gift-img.show{
 opacity:1;
 transform:scale(1);
}

/* ---------- CONFETTIS ---------- */
.confetti{
 position:fixed;
 width:10px;
 height:10px;
 top:0;
 pointer-events:none;
}

</style>
</head>

<body>

<div class="ticket">

<h2 id="title">üéÅ Gratte pour d√©couvrir ton cadeau üéÅ</h2>

<div id="scratch-container">
<canvas id="scratch"></canvas>
</div>

<div id="question1">
<h3>Question 1</h3>
<p>Pour qui chanterais-tu : [...] Le Rouge et Noir, l‚ÄôEurope les jalouses
C‚Äôest la couleur de l‚Äôunique vainqueur [...] ?</p>

<button onclick="checkQ1(false)">Perpignan</button>
<button onclick="checkQ1(true)">Stade Toulousain</button>
<button onclick="checkQ1(false)">Saint-Marin</button>
</div>

<div id="question2">
<h3>Question 2</h3>
<p>Si tu devais te faire monter en l'air, qu'elle serais le choix le moins douloureux ?</p>

<button onclick="checkQ2(true)">Air Force One</button>
<button onclick="checkQ2(false)">Vincent Mc Doom</button>
<button onclick="checkQ2(false)">Benoit Saint Denis</button>
</div>

<div id="revealBtn">
<button onclick="showGift()">üéÅ R√©v√©ler le cadeau</button>
</div>

<div id="result">

<div class="boarding-pass">

<div class="flight-title">‚úàÔ∏è Billet Surprise</div>

<div class="flight-row">
<span>PASSAGER</span>
<strong>Surprise</strong>
</div>

<div class="flight-row">
<span>DESTINATION</span>
<strong>ROME</strong>
</div>

<div class="flight-row">
<span>D√âPART</span>
<strong>Bient√¥t</strong>
</div>

<div class="flight-row">
<span>PORTE</span>
<strong>VIP</strong>
</div>

</div>

<!-- IMAGE CADEAU -->
<img src="cadeau.jpg" class="gift-img" id="giftImage">

</div>

</div>

<script>

/* SCRATCH */
const canvas=document.getElementById("scratch");
const ctx=canvas.getContext("2d");

let scratching=false;
let revealed=false;

/* responsive */
function resizeCanvas(){
 canvas.width=canvas.clientWidth;
 canvas.height=canvas.clientHeight;
 drawOverlay();
}
window.addEventListener("resize",resizeCanvas);
resizeCanvas();

/* overlay */
function drawOverlay(){
 ctx.globalCompositeOperation="source-over";
 ctx.fillStyle="#999";
 ctx.fillRect(0,0,canvas.width,canvas.height);

 ctx.fillStyle="white";
 ctx.font=(canvas.width/10)+"px Arial";
 ctx.fillText("GRATTE ICI",canvas.width/4,canvas.height/2);
}

/* position doigt */
function getTouchPos(e){
 const rect=canvas.getBoundingClientRect();
 return{
  x:e.touches[0].clientX-rect.left,
  y:e.touches[0].clientY-rect.top
 };
}

/* MOBILE FIX */
canvas.addEventListener("touchstart",e=>{
 scratching=true;
 e.preventDefault();
},{passive:false});

canvas.addEventListener("touchmove",e=>{
 if(!scratching) return;
 const pos=getTouchPos(e);
 scratch(pos.x,pos.y);
 e.preventDefault();
},{passive:false});

canvas.addEventListener("touchend",()=>scratching=false);

/* DESKTOP */
canvas.addEventListener("mousedown",()=>scratching=true);
canvas.addEventListener("mouseup",()=>scratching=false);
canvas.addEventListener("mousemove",e=>{
 if(!scratching) return;
 scratch(e.offsetX,e.offsetY);
});

/* effet poudre */
function scratch(x,y){
 for(let i=0;i<6;i++){
  ctx.globalCompositeOperation="destination-out";
  ctx.beginPath();
  ctx.arc(
    x+(Math.random()*20-10),
    y+(Math.random()*20-10),
    Math.random()*12+6,
    0,Math.PI*2
  );
  ctx.fill();
 }
 checkScratch();
}

/* v√©rification 85% */
function checkScratch(){
 if(revealed) return;

 const pixels=ctx.getImageData(0,0,canvas.width,canvas.height);
 let count=0;

 for(let i=0;i<pixels.data.length;i+=4){
  if(pixels.data[i+3]==0) count++;
 }

 let percent=count/(canvas.width*canvas.height);

 if(percent>0.85){
  revealed=true;

  document.getElementById("scratch-container").remove();
  document.getElementById("title").remove();

  fadeIn(question1);
 }
}

/* transitions */
function fadeIn(el){
 el.style.display="block";
 setTimeout(()=>el.style.opacity=1,10);
}

function fadeOut(el,cb){
 el.style.opacity=0;
 setTimeout(()=>{
  el.style.display="none";
  if(cb) cb();
 },500);
}

/* quiz */
function checkQ1(ok){
 if(ok){
  fadeOut(question1,()=>fadeIn(question2));
 }else alert("Presque !");
}

function checkQ2(ok){
 if(ok){
  fadeOut(question2,()=>fadeIn(revealBtn));
 }else alert("Pas loin !");
}

/* cadeau + billet */
function showGift(){
 fadeOut(revealBtn,()=>{
  fadeIn(result);

  // apparition image cadeau apr√®s billet
  const gift = document.getElementById("giftImage");
  setTimeout(()=>gift.classList.add("show"),600);

  createConfetti();
 });
}

/* confettis */
function createConfetti(){
 for(let i=0;i<120;i++){
  const c=document.createElement("div");
  c.className="confetti";
  c.style.left=Math.random()*window.innerWidth+"px";
  c.style.background=`hsl(${Math.random()*360},100%,50%)`;
  document.body.appendChild(c);
  animateConfetti(c);
 }
}

function animateConfetti(el){
 let top=0;
 const fall=setInterval(()=>{
  top+=Math.random()*5+2;
  el.style.top=top+"px";

  if(top>window.innerHeight){
   el.remove();
   clearInterval(fall);
  }
 },20);
}

</script>

</body>
</html>
